{"title":"Predicting Pre-Eclampsia in Nulliparous Pregnancy Outcomes Study","markdown":{"yaml":{"title":"Predicting Pre-Eclampsia in Nulliparous Pregnancy Outcomes Study","description":"A comparative study of five classification algorithms for early-pregnancy risk stratification","format":{"html":{"toc":true,"number-sections":true,"code-fold":true,"page-layout":"full"}}},"headingText":"Motivation","containsRefs":false,"markdown":"\n\n\nPre-eclampsia (PE) is a hypertensive disorder that threatens maternal–fetal health worldwide.  \nEarly, data-driven risk stratification allows obstetric teams to intensify surveillance and tailor interventions.  \nUsing the **Nulliparous Pregnancy Outcomes Study (nuMoM2b)** cohort, we benchmarked five off-the-shelf classifiers—logistic regression, decision tree, random forest, AdaBoost, and a shallow artificial neural network (ANN)—to predict incident PE from routine first-trimester information.\n\n## Data\n\n### Cohort & Design  \n\n* **Sample**   7626 nulliparous women enrolled at ≤ 14 weeks’ gestation.  \n* **Outcome**  Binary indicator aggregated from six original PE severity categories (1 = any PE, 0 = none).  \n* **Predictors** 30 baseline variables spanning 12 themes:\n\n| Theme (examples) | Count |\n|------------------|------:|\n| Demographics (age, race, income) | 3 |\n| Partner support (emotional, financial, delivery) | 4 |\n| Mental health (PSS-10, STAI-T, EPDS) | 3 |\n| Worry scales (family, healthcare, symptoms) | 3 |\n| Clinical vitals (systolic / diastolic BP) | 2 |\n| Physical activity (exercise past 4 weeks) | 1 |\n| Medical history (kidney, lupus, collagen vascular, Crohn’s, PCOS) | 5 |\n| Birth history (born early) | 1 |\n| Family PE history | 1 |\n| Weight (pre-pregnancy lbs) | 1 |\n| Discrimination score | 1 |\n| Race dummies (after one-hot encoding) | 6 |\n\nMissing **age** rows (< 0.3 %) were dropped; categorical levels were one-hot encoded; rare disease indicators were re-leveled to binary 0/1. Data were split 70 / 30 using stratified sampling. \n\n## Methods\n\nWe evaluated each classifier with 5-fold cross-validation on the training set, tuning key hyper-parameters by AUC:\n\n| Model | Main hyper-parameters (grid) |\n|-------|-----------------------------|\n| Logistic regression | none (liblinear solver) |\n| Decision tree | `max_depth ∈ {2, 3, 5, 6, 8}`, `max_features ∈ {3, 5, 10, 15}` |\n| Random forest | `n_estimators ∈ {10, 50, 100}`, `max_depth ∈ {5, 7, None}`, `bootstrap ∈ {True, False}` |\n| AdaBoost | `n_estimators ∈ {50, 100, 200}`, weak learner depth ∈ {1, 2} |\n| ANN | two hidden layers, nodes = 10 each; tuned `batch_size ∈ {16, 32}`, `epochs ∈ {100, 200}` |\n\n### Evaluation Metrics\n\nBecause only **23.5 %** of pregnancies developed PE, we prioritised the **F₁-score** (harmonic mean of precision & recall), with precision–recall and ROC curves as secondary diagnostics.\n\n## Results\n\n### Overall Performance\n\n| Model | Precision | Recall | F₁ | Notes |\n|------:|----------:|-------:|---:|-------|\n| Logistic regression | 0.342 | 0.598 | **0.435** | Simple, interpretable |\n| Decision tree | 0.295 | 0.711 | 0.418 | Depth = 5, 15 features |\n| **Random forest** | 0.330 | 0.665 | **0.441** | 50 trees, depth = 7 |\n| AdaBoost | 0.238 | **0.998** | 0.383 | 100 stumps; best recall |\n| ANN | 0.278 | 0.776 | 0.409 | 2 × 10 nodes, 200 epochs |\n\nAlthough the **random-forest** model achieved an F₁-score of **0.441**, beating **logistic regression** (F₁ = 0.435) by **0.006 (0.6 percentage-points)**, this gap is **smaller than one cross-validation standard error**. In practical terms, the two models are statistically indistinguishable on this dataset.\n\n* **Interpretation.**  \n  * **Random forest** captures complex, non-linear interactions and therefore has lower **bias** than logistic regression.  \n  * However, with only ~5 k training records and 30 predictors, that extra flexibility adds **variance** without yielding a meaningful boost in out-of-sample F₁.  \n  * The near-tie underscores a common lesson for modest-sized tabular data: **parsimonious, easily interpretable models often rival more complex ensembles** once uncertainty is taken into account.\n\nTherefore, unless interpretability is secondary and computational cost negligible, logistic regression (or a lightly regularised variant) remains the more pragmatic baseline.\n \n\n### Key Predictors\n\n#### Tree-based feature importance consistently selected:\n\n1. Pre-pregnancy weight (lbs)  \n2. Systolic blood pressure (mm Hg)  \n3. Diastolic blood pressure (mm Hg)  \n4. Age (years)  \n5. STAI-T anxiety score  \n6. PSS stress score\n\n#### Effect sizes (logistic regression)\n\nHolding the other 29 baseline variables constant, the fitted logistic model yielded two notably precise effect estimates:\n\n| Predictor | Per-unit odds ratio (OR) | 95 % CI | Practical interpretation |\n|-----------|-------------------------|---------|--------------------------|\n| Pre-pregnancy weight (lb) | **1.0054** | 1.004 – 1.007 | Each **10 lb** gain raises the odds of PE by **≈ 5 %**. |\n| Systolic blood pressure (mm Hg) | **1.019** | 1.01 – 1.03 | Each **10 mm Hg** rise raises the odds by **≈ 22 %**. |\n\nOn the 30 % hold-out test set the same model achieved **precision = 0.342**, **recall = 0.598**, and **F₁ = 0.435**.  \nThus, while weight and blood pressure provide statistically robust signals (p < 0.001), their modest incremental odds underscore that early-pregnancy PE risk is multifactorial, limiting overall discrimination when using first-trimester data alone. \n\n\n## Discussion\n\n* **Clinical insight**:   Both physiological (weight, BP) and psychological (stress, anxiety) domains contribute materially to PE risk, aligning with literature on cardiometabolic pathways.  \n* **Model choice**:     Given comparable F₁ and superior interpretability, *penalised* logistic regression or monotonic gradient-boosting could offer a pragmatic middle ground.  \n* **Limitations**:     Class imbalance capped F₁ ceilings; advanced re-sampling (e.g., SMOTE) or cost-sensitive loss could help.  \n  – Some variables show implausible zeros (e.g., age, income); future work should scrutinise and impute rather than drop.  \n  – External validity is untested; replication on multiparous or broader populations is needed.\n\n\n","srcMarkdownNoYaml":"\n\n## Motivation\n\nPre-eclampsia (PE) is a hypertensive disorder that threatens maternal–fetal health worldwide.  \nEarly, data-driven risk stratification allows obstetric teams to intensify surveillance and tailor interventions.  \nUsing the **Nulliparous Pregnancy Outcomes Study (nuMoM2b)** cohort, we benchmarked five off-the-shelf classifiers—logistic regression, decision tree, random forest, AdaBoost, and a shallow artificial neural network (ANN)—to predict incident PE from routine first-trimester information.\n\n## Data\n\n### Cohort & Design  \n\n* **Sample**   7626 nulliparous women enrolled at ≤ 14 weeks’ gestation.  \n* **Outcome**  Binary indicator aggregated from six original PE severity categories (1 = any PE, 0 = none).  \n* **Predictors** 30 baseline variables spanning 12 themes:\n\n| Theme (examples) | Count |\n|------------------|------:|\n| Demographics (age, race, income) | 3 |\n| Partner support (emotional, financial, delivery) | 4 |\n| Mental health (PSS-10, STAI-T, EPDS) | 3 |\n| Worry scales (family, healthcare, symptoms) | 3 |\n| Clinical vitals (systolic / diastolic BP) | 2 |\n| Physical activity (exercise past 4 weeks) | 1 |\n| Medical history (kidney, lupus, collagen vascular, Crohn’s, PCOS) | 5 |\n| Birth history (born early) | 1 |\n| Family PE history | 1 |\n| Weight (pre-pregnancy lbs) | 1 |\n| Discrimination score | 1 |\n| Race dummies (after one-hot encoding) | 6 |\n\nMissing **age** rows (< 0.3 %) were dropped; categorical levels were one-hot encoded; rare disease indicators were re-leveled to binary 0/1. Data were split 70 / 30 using stratified sampling. \n\n## Methods\n\nWe evaluated each classifier with 5-fold cross-validation on the training set, tuning key hyper-parameters by AUC:\n\n| Model | Main hyper-parameters (grid) |\n|-------|-----------------------------|\n| Logistic regression | none (liblinear solver) |\n| Decision tree | `max_depth ∈ {2, 3, 5, 6, 8}`, `max_features ∈ {3, 5, 10, 15}` |\n| Random forest | `n_estimators ∈ {10, 50, 100}`, `max_depth ∈ {5, 7, None}`, `bootstrap ∈ {True, False}` |\n| AdaBoost | `n_estimators ∈ {50, 100, 200}`, weak learner depth ∈ {1, 2} |\n| ANN | two hidden layers, nodes = 10 each; tuned `batch_size ∈ {16, 32}`, `epochs ∈ {100, 200}` |\n\n### Evaluation Metrics\n\nBecause only **23.5 %** of pregnancies developed PE, we prioritised the **F₁-score** (harmonic mean of precision & recall), with precision–recall and ROC curves as secondary diagnostics.\n\n## Results\n\n### Overall Performance\n\n| Model | Precision | Recall | F₁ | Notes |\n|------:|----------:|-------:|---:|-------|\n| Logistic regression | 0.342 | 0.598 | **0.435** | Simple, interpretable |\n| Decision tree | 0.295 | 0.711 | 0.418 | Depth = 5, 15 features |\n| **Random forest** | 0.330 | 0.665 | **0.441** | 50 trees, depth = 7 |\n| AdaBoost | 0.238 | **0.998** | 0.383 | 100 stumps; best recall |\n| ANN | 0.278 | 0.776 | 0.409 | 2 × 10 nodes, 200 epochs |\n\nAlthough the **random-forest** model achieved an F₁-score of **0.441**, beating **logistic regression** (F₁ = 0.435) by **0.006 (0.6 percentage-points)**, this gap is **smaller than one cross-validation standard error**. In practical terms, the two models are statistically indistinguishable on this dataset.\n\n* **Interpretation.**  \n  * **Random forest** captures complex, non-linear interactions and therefore has lower **bias** than logistic regression.  \n  * However, with only ~5 k training records and 30 predictors, that extra flexibility adds **variance** without yielding a meaningful boost in out-of-sample F₁.  \n  * The near-tie underscores a common lesson for modest-sized tabular data: **parsimonious, easily interpretable models often rival more complex ensembles** once uncertainty is taken into account.\n\nTherefore, unless interpretability is secondary and computational cost negligible, logistic regression (or a lightly regularised variant) remains the more pragmatic baseline.\n \n\n### Key Predictors\n\n#### Tree-based feature importance consistently selected:\n\n1. Pre-pregnancy weight (lbs)  \n2. Systolic blood pressure (mm Hg)  \n3. Diastolic blood pressure (mm Hg)  \n4. Age (years)  \n5. STAI-T anxiety score  \n6. PSS stress score\n\n#### Effect sizes (logistic regression)\n\nHolding the other 29 baseline variables constant, the fitted logistic model yielded two notably precise effect estimates:\n\n| Predictor | Per-unit odds ratio (OR) | 95 % CI | Practical interpretation |\n|-----------|-------------------------|---------|--------------------------|\n| Pre-pregnancy weight (lb) | **1.0054** | 1.004 – 1.007 | Each **10 lb** gain raises the odds of PE by **≈ 5 %**. |\n| Systolic blood pressure (mm Hg) | **1.019** | 1.01 – 1.03 | Each **10 mm Hg** rise raises the odds by **≈ 22 %**. |\n\nOn the 30 % hold-out test set the same model achieved **precision = 0.342**, **recall = 0.598**, and **F₁ = 0.435**.  \nThus, while weight and blood pressure provide statistically robust signals (p < 0.001), their modest incremental odds underscore that early-pregnancy PE risk is multifactorial, limiting overall discrimination when using first-trimester data alone. \n\n\n## Discussion\n\n* **Clinical insight**:   Both physiological (weight, BP) and psychological (stress, anxiety) domains contribute materially to PE risk, aligning with literature on cardiometabolic pathways.  \n* **Model choice**:     Given comparable F₁ and superior interpretability, *penalised* logistic regression or monotonic gradient-boosting could offer a pragmatic middle ground.  \n* **Limitations**:     Class imbalance capped F₁ ceilings; advanced re-sampling (e.g., SMOTE) or cost-sensitive loss could help.  \n  – Some variables show implausible zeros (e.g., age, income); future work should scrutinise and impute rather than drop.  \n  – External validity is untested; replication on multiparous or broader populations is needed.\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"highlight-style":"github","number-sections":true,"output-file":"PreEclampsia.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","theme":"cosmo","title":"Predicting Pre-Eclampsia in Nulliparous Pregnancy Outcomes Study","description":"A comparative study of five classification algorithms for early-pregnancy risk stratification","page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}